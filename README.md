This is the majority of business logic for our code
